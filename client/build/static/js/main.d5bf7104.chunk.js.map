{"version":3,"sources":["Login.js","Player.js","TrackSearchResult.js","Dashboard.js","useAuth.js","App.js","index.js"],"names":["Login","Container","className","style","minHeight","href","Player","accessToken","trackUri","useState","play","setPlay","useEffect","token","showSaveIcon","callback","state","isPlaying","uris","TrackSearchResult","track","chooseTrack","cursor","onClick","src","albumUrl","height","width","title","artist","spotifyApi","SpotifyWebApi","clientId","Dashboard","code","setAccessToken","refreshToken","setRefreshToken","expiresIn","setExpiresIn","axios","post","then","res","data","catch","window","location","interval","setInterval","clearInterval","useAuth","search","setSearch","searchResults","setSearchResults","playingTrack","setPlayingTrack","lyrics","setLyrics","get","params","cancel","searchTracks","body","tracks","items","map","smallestAlbumImage","album","images","reduce","smallest","image","artists","name","uri","url","Form","Control","type","placeholder","value","onChange","e","target","overflowY","length","whiteSpace","URLSearchParams","App","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.d5bf7104.chunk.js","sourcesContent":["import React from \"react\";\nimport { Container } from \"react-bootstrap\";\n\nconst AUTH_URL =\n  \"https://accounts.spotify.com/authorize?client_id=54341c7655a44105915ad337f8320cad&response_type=code&redirect_uri=http://localhost:3000&scope=streaming%20user-read-email%20user-read-private%20user-library-read%20user-library-modify%20user-read-playback-state%20user-modify-playback-state\";\n\nexport default function Login() {\n  return (\n    <Container\n      className=\"d-flex justify-content-center align-items-center\"\n      style={{ minHeight: \"100vh\" }}\n    >\n      <a className=\"btn btn-success btn-lg\" href={AUTH_URL}>\n        Login With Spotify\n      </a>\n    </Container>\n  );\n}\n","import { useState, useEffect } from \"react\"\nimport SpotifyPlayer from \"react-spotify-web-playback\"\n\nexport default function Player({ accessToken, trackUri }) {\n  const [play, setPlay] = useState(false)\n\n  useEffect(() => setPlay(true), [trackUri])\n\n  if (!accessToken) return null\n  return (\n    <SpotifyPlayer\n      token={accessToken}\n      showSaveIcon\n      callback={state => {\n        if (!state.isPlaying) setPlay(false)\n      }}\n      play={play}\n      uris={trackUri ? [trackUri] : []}\n    />\n  )\n}\n","import React from \"react\"\n\nexport default function TrackSearchResult({ track, chooseTrack }) {\n  function handlePlay() {\n    chooseTrack(track)\n  }\n\n  return (\n    <div\n      className=\"d-flex m-2 align-items-center\"\n      style={{ cursor: \"pointer\" }}\n      onClick={handlePlay}\n    >\n      <img src={track.albumUrl} style={{ height: \"64px\", width: \"64px\" }} />\n      <div className=\"ml-3\">\n        <div>{track.title}</div>\n        <div className=\"text-muted\">{track.artist}</div>\n      </div>\n    </div>\n  )\n}\n","import { useState, useEffect } from \"react\";\nimport useAuth from \"./useAuth\";\nimport Player from \"./Player\";\nimport TrackSearchResult from \"./TrackSearchResult\";\nimport { Container, Form } from \"react-bootstrap\";\nimport SpotifyWebApi from \"spotify-web-api-node\";\nimport axios from \"axios\";\n\nconst spotifyApi = new SpotifyWebApi({\n  clientId: \"54341c7655a44105915ad337f8320cad\",\n});\n\nexport default function Dashboard({ code }) {\n  const accessToken = useAuth(code);\n  const [search, setSearch] = useState(\"\");\n  const [searchResults, setSearchResults] = useState([]);\n  const [playingTrack, setPlayingTrack] = useState();\n  const [lyrics, setLyrics] = useState(\"\");\n\n  function chooseTrack(track) {\n    setPlayingTrack(track);\n    setSearch(\"\");\n    setLyrics(\"\");\n  }\n\n  useEffect(() => {\n    if (!playingTrack) return;\n\n    axios\n      .get(\"http://localhost:3001/lyrics\", {\n        params: {\n          track: playingTrack.title,\n          artist: playingTrack.artist,\n        },\n      })\n      .then((res) => {\n        setLyrics(res.data.lyrics);\n      });\n  }, [playingTrack]);\n\n  useEffect(() => {\n    if (!accessToken) return;\n    spotifyApi.setAccessToken(accessToken);\n  }, [accessToken]);\n\n  useEffect(() => {\n    if (!search) return setSearchResults([]);\n    if (!accessToken) return;\n\n    let cancel = false;\n    spotifyApi.searchTracks(search).then((res) => {\n      if (cancel) return;\n      setSearchResults(\n        res.body.tracks.items.map((track) => {\n          const smallestAlbumImage = track.album.images.reduce(\n            (smallest, image) => {\n              if (image.height < smallest.height) return image;\n              return smallest;\n            },\n            track.album.images[0]\n          );\n\n          return {\n            artist: track.artists[0].name,\n            title: track.name,\n            uri: track.uri,\n            albumUrl: smallestAlbumImage.url,\n          };\n        })\n      );\n    });\n\n    return () => (cancel = true);\n  }, [search, accessToken]);\n\n  return (\n    <Container className=\"d-flex flex-column py-2\" style={{ height: \"100vh\" }}>\n      <Form.Control\n        type=\"search\"\n        placeholder=\"Search Songs/Artists\"\n        value={search}\n        onChange={(e) => setSearch(e.target.value)}\n      />\n      <div className=\"flex-grow-1 my-2\" style={{ overflowY: \"auto\" }}>\n        {searchResults.map((track) => (\n          <TrackSearchResult\n            track={track}\n            key={track.uri}\n            chooseTrack={chooseTrack}\n          />\n        ))}\n        {searchResults.length === 0 && (\n          <div className=\"text-center\" style={{ whiteSpace: \"pre\" }}>\n            {lyrics}\n          </div>\n        )}\n      </div>\n      <div>\n        <Player accessToken={accessToken} trackUri={playingTrack?.uri} />\n      </div>\n    </Container>\n  );\n}\n","import { useState, useEffect } from \"react\";\nimport axios from \"axios\";\n\nexport default function useAuth(code) {\n  const [accessToken, setAccessToken] = useState();\n  const [refreshToken, setRefreshToken] = useState();\n  const [expiresIn, setExpiresIn] = useState();\n\n  useEffect(() => {\n    axios\n      .post(\"http://localhost:3001/login\", {\n        code,\n      })\n      .then((res) => {\n        setAccessToken(res.data.accessToken);\n        setRefreshToken(res.data.refreshToken);\n        setExpiresIn(res.data.expiresIn);\n        // window.history.pushState({}, null, \"/\")\n      })\n      .catch(() => {\n        window.location = \"/\";\n      });\n  }, [code]);\n\n  useEffect(() => {\n    if (!refreshToken || !expiresIn) return;\n    const interval = setInterval(() => {\n      axios\n        .post(\"http://localhost:3001/refresh\", {\n          refreshToken,\n        })\n        .then((res) => {\n          setAccessToken(res.data.accessToken);\n          setExpiresIn(res.data.expiresIn);\n        })\n        .catch(() => {\n          window.location = \"/\";\n        });\n    }, (expiresIn - 60) * 1000);\n\n    return () => clearInterval(interval);\n  }, [refreshToken, expiresIn]);\n\n  return accessToken;\n}\n","import \"bootstrap/dist/css/bootstrap.min.css\"\nimport Login from \"./Login\"\nimport Dashboard from \"./Dashboard\"\n\nconst code = new URLSearchParams(window.location.search).get(\"code\")\n\nfunction App() {\n  return code ? <Dashboard code={code} /> : <Login />\n}\n\nexport default App\n","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport App from \"./App\"\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n)\n"],"sourceRoot":""}